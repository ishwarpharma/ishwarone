<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ishwar Pharma Order Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f2f2f2;
    }

    header {
      background-color: #4CAF50;
      color: white;
      padding: 15px;
      font-size: 1.5em;
      text-align: center;
    }

    main {
      padding: 20px;
    }

    .screen {
      display: none;
    }

    .screen.active {
      display: block;
    }

    label {
      display: block;
      margin: 10px 0 5px;
    }

    input, select, button, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    .product-entry {
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #fff;
    }

    .cart-item {
      padding: 10px;
      border-bottom: 1px solid #ccc;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-item span {
      flex: 1;
    }

    .cart-item button {
      width: auto;
      margin-left: 5px;
      padding: 5px 10px;
    }

    #cart {
      background-color: #fff;
      padding: 10px;
      border-radius: 5px;
    }
  </style>
</head>

<body>
  <script>
    window.onload = function () {
      const dateField = document.getElementById("date");
      const today = new Date().toISOString().slice(0, 10);
      dateField.value = today;
    };
  </script>

  <header>üìù Ishwar Pharma Order Form</header>

  <main>
    <div class="screen active" id="screen1">
      <label>Date:</label>
      <input type="text" id="date" readonly>
      <label>Salesman Name:</label>
      <input type="text" id="salesman">
      <label>Party Name:</label>
      <input type="text" id="party">
      <label>Place/District:</label>
      <input type="text" id="place">
      <button onclick="nextScreen()">üöÄ Start Ordering</button>
    </div>

    <div class="screen" id="screen2">
      <label>Search Product:</label>
      <input type="text" id="search" oninput="filterProducts()" placeholder="Enter brand or company name">

      <div id="productList"></div>

      <div id="entryForm" style="display:none;">
        <label>Qty:</label>
        <input type="number" id="qty">
        <label>Discount %:</label>
        <input type="number" id="discount">
        <label>Special Rate:</label>
        <input type="number" id="specialRate">
        <p id="rateInfo"></p>
        <button onclick="addToCart()">‚ûï Add to Cart</button>
      </div>

      <div id="cart">
        <h3>üõí Cart Items</h3>
        <div id="cartItems"></div>
        <button onclick="finalizeOrder()">‚úÖ Finalize & Download</button>
      </div>
    </div>
  </main>

  <script>
    const products = [
      { name: "URODIV 150", company: "Synokem", rate: 20.00, mrp: 35.00 },
      { name: "ZERODER SP", company: "Ishwar Pharma", rate: 10.00, mrp: 20.00 },
      { name: "ZERODER MR", company: "Ishwar Pharma", rate: 15.00, mrp: 30.00 }
    ];

    let selectedProduct = null;
    let cart = [];

    function nextScreen() {
      const salesman = document.getElementById("salesman").value;
      const party = document.getElementById("party").value;
      const place = document.getElementById("place").value;
      if (!salesman || !party || !place) {
        alert("Please fill all details");
        return;
      }
      document.getElementById("screen1").classList.remove("active");
      document.getElementById("screen2").classList.add("active");
    }

    function filterProducts() {
      const query = document.getElementById("search").value.toLowerCase();
      const list = document.getElementById("productList");
      list.innerHTML = "";
      products.forEach(prod => {
        if ((prod.name + " " + prod.company).toLowerCase().includes(query)) {
          const btn = document.createElement("button");
          btn.textContent = `${prod.name} (${prod.company})`;
          btn.onclick = () => showEntryForm(prod);
          list.appendChild(btn);
        }
      });
    }

    function showEntryForm(prod) {
      selectedProduct = prod;
      document.getElementById("entryForm").style.display = "block";
      document.getElementById("rateInfo").textContent = `Normal Rate: ‚Çπ${prod.rate}, MRP: ‚Çπ${prod.mrp}`;
    }

    function addToCart() {
      const qty = parseFloat(document.getElementById("qty").value);
      const discount = parseFloat(document.getElementById("discount").value);
      const specialRate = parseFloat(document.getElementById("specialRate").value);
      if (!selectedProduct || isNaN(qty)) {
        alert("Select product and enter quantity");
        return;
      }
      const amount = specialRate * qty * (1 - discount / 100);
      cart.push({
        ...selectedProduct,
        qty, discount, specialRate, amount
      });
      document.getElementById("search").value = "";
      document.getElementById("entryForm").style.display = "none";
      document.getElementById("qty").value = "";
      document.getElementById("discount").value = "";
      document.getElementById("specialRate").value = "";
      document.getElementById("rateInfo").textContent = "";
      updateCart();
    }

    function updateCart() {
      const cartItems = document.getElementById("cartItems");
      cartItems.innerHTML = "";
      cart.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "cart-item";
        div.innerHTML = `
          <span>${index + 1}. ${item.name}</span>
          <span>${item.qty} pcs</span>
          <span>‚Çπ${item.specialRate}</span>
          <span>${item.discount}%</span>
          <span>‚Çπ${item.amount.toFixed(2)}</span>
          <button onclick="removeItem(${index})">üóëÔ∏è</button>
        `;
        cartItems.appendChild(div);
      });
    }

    function removeItem(i) {
      cart.splice(i, 1);
      updateCart();
    }

    function finalizeOrder() {
      let content = "Ishwar Pharma Order\n\n";
      content += `Date: ${document.getElementById("date").value}\n`;
      content += `Salesman: ${document.getElementById("salesman").value}\n`;
      content += `Party: ${document.getElementById("party").value}\n`;
      content += `Place: ${document.getElementById("place").value}\n\n`;
      content += "S.No\tProduct\tQty\tRate\tDisc%\tAmount\n";
      let total = 0;
      cart.forEach((item, i) => {
        total += item.amount;
        content += `${i + 1}\t${item.name}\t${item.qty}\t‚Çπ${item.specialRate}\t${item.discount}%\t‚Çπ${item.amount.toFixed(2)}\n`;
      });
      content += `\nTotal Amount: ‚Çπ${total.toFixed(2)}`;

      const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "order.txt";
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>

</html>
