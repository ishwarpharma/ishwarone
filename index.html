<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sales Order Form</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #e8f4fd; padding: 20px; }
    label { display: block; margin: 15px 0 5px; font-weight: bold; }
    input, select, button { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #007bff; color: white; border: none; cursor: pointer; margin-top: 20px; }
    button:hover { background: #0056b3; }
    .autocomplete-items { border: 1px solid #ccc; max-height: 150px; overflow-y: auto; background: white; position: absolute; z-index: 9999; width: calc(100% - 22px); }
    .autocomplete-items div { padding: 10px; cursor: pointer; }
    .autocomplete-items div:hover { background-color: #e9e9e9; }
    .autocomplete { position: relative; display: block; }
  </style>
</head>
<body>

<h2>üõí Search Product:</h2>
<div class="autocomplete">
  <input type="text" id="searchInput" placeholder="Type product or company name...">
  <div id="autocompleteList" class="autocomplete-items"></div>
</div>

<label>üî¢ Quantity:</label>
<input type="number" id="quantity">

<label>üí∏ Discount %:</label>
<input type="number" id="discount">

<label>‚≠ê Special Rate (if any):</label>
<input type="text" id="specialRate">

<button onclick="addToCart()">Add to Cart üõí</button>
<button onclick="finalizeOrder()">üìÑ Finalize Order & Download PDF</button>

<script>
let products = []

// Load stock.xlsx and extract product info
fetch("stock.xlsx")
  .then(res => res.arrayBuffer())
  .then(ab => {
    const wb = XLSX.read(ab, { type: "array" });
    const ws = wb.Sheets[wb.SheetNames[0]];
    const json = XLSX.utils.sheet_to_json(ws);
    products = json.map(row => ({
      name: row["Product Name"],
      company: row["Company"],
      rate: row["Rate"],
      stock: row["Stock"]
    }));
  });

const searchInput = document.getElementById("searchInput");
const autocompleteList = document.getElementById("autocompleteList");

searchInput.addEventListener("input", function () {
  const val = this.value.toLowerCase();
  autocompleteList.innerHTML = "";
  if (val.length < 3) return;

  const filtered = products.filter(p =>
    (p.name && p.name.toLowerCase().includes(val)) ||
    (p.company && p.company.toLowerCase().includes(val))
  ).slice(0, 20);

  filtered.forEach(p => {
    const div = document.createElement("div");
    div.innerHTML = `<strong>${p.name}</strong> <small>(${p.company})</small>`;
    div.onclick = () => {
      searchInput.value = p.name;
      autocompleteList.innerHTML = "";
    };
    autocompleteList.appendChild(div);
  });
});

function addToCart() {
  alert("Product added to cart! [This part can be enhanced further]");
}

function finalizeOrder() {
  alert("PDF generated! [This part can be integrated with jsPDF]");
}
</script>

</body>
</html>
